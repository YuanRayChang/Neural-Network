clear ; close all; clc

%%
% load 'Iris.dat';
% X_iris_train=[(Iris(1:35,1:4));(Iris(51:85,1:4));(Iris(101:135,1:4))];
% Y_iris_train=[(Iris(1:35,5));(Iris(51:85,5));(Iris(101:135,5))];
% X_iris_test=[(Iris(36:50,1:4));(Iris(86:100,1:4));(Iris(136:150,1:4))];
% Y_iris_test=[(Iris(36:50,5));(Iris(86:100,5));(Iris(136:150,5))];
% 
% X_iris_train=normalization(X_iris_train);
% X_iris_test=normalization(X_iris_test);
% 
% p = [91,52,2,39,19,61,101,59,83,62,77,64,23,94,29,78,27,68,93,54,79,49,38,96,12,7,50,24,103,89,36,25,98,17,95,80,16,84,86,104,90,75,74,8,58,42,5,13,97,53,31,41,57,70,11,63,85,10,105,48,6,44,45,14,88,72,30,87,69,15,26,60,37,56,33,28,67,4,102,40,32,22,73,1,82,47,66,65,76,81,46,20,51,35,34,43,21,100,3,99,9,71,55,92,18];
% X_iris_train=X_iris_train(p,:);
% Y_iris_train=Y_iris_train(p,:);
% 
% input_layer_size=4;
% first_hidden_layer_size=2;
% second_hidden_layer_size=3;
% output_layer_size=3;
% 
% initial_weight1 = [0.601981941401637,0.748151592823710;0.262971284540144,0.450541598502498;0.654079098476782,0.0838213779969326;0.689214503140008,0.228976968716819];
% initial_weight2 = [0.913337361501670,0.825816977489547,0.996134716626886;0.152378018969223,0.538342435260057,0.0781755287531837];
% initial_weight3 = [0.442678269775446,0.00463422413406744,0.868694705363510;0.106652770180584,0.774910464711502,0.0844358455109103;0.961898080855054,0.817303220653433,0.399782649098897];
% initial_bias1   = [0.259870402850654,0.800068480224308];
% initial_bias2   = [0.431413827463545,0.910647594429523,0.181847028302853];
% initial_bias3   = [0.263802916521990,0.145538980384717,0.136068558708664];
% 
% disp 'start training Iris';
% 
% w1 = initial_weight1;
% w2 = initial_weight2;
% w3 = initial_weight3;
% b1 = initial_bias1;
% b2 = initial_bias2;
% b3 = initial_bias3;
% accuracy_rate_iris = zeros(50,1);
% count = 0;
% p_iris = predict(w1,w2,w3,b1,b2,b3,X_iris_test);
% for j=1:50
% total_error = 0;
% for i=1:size(X_iris_train,1)
% [cost,w1,w2,w3,b1,b2,b3] = train_part1_hs(w1,w2,w3,b1,b2,b3,X_iris_train(i,:),Y_iris_train(i,:));
% end
% %count = count + 1;
% p_iris = predict(w1,w2,w3,b1,b2,b3,X_iris_test);
% accuracy_rate_iris(j) = accuracy(p_iris,Y_iris_test);
% end
% disp 'finish training Iris';
% 
% x_axis = 1:size(X_iris_test,1);
% plot(x_axis,Y_iris_test,'r',x_axis,p_iris,'bo');
% legend('desired output','prediction','location','northwest');
% 
% set(gcf, 'PaperPosition', [0 0 15 15]); %Position plot at left hand corner with width 5 and height 5.
% set(gcf, 'PaperSize', [15 15]); %Set the paper to have width 5 and height 5.
%saveas(gcf, 'irishhb01', 'pdf') %Save figure
%% wine 
% load 'wine.data.txt';
% X_wine_train=[(wine_data(1:50,2:14));(wine_data(60:115,2:14));(wine_data(131:170,2:14))];
% Y_wine_train=[(wine_data(1:50,1));(wine_data(60:115,1));(wine_data(131:170,1))];
% X_wine_test=[(wine_data(51:59,2:14));(wine_data(116:130,2:14));(wine_data(171:178,2:14))];
% Y_wine_test=[(wine_data(51:59,1));(wine_data(116:130,1));(wine_data(171:178,1))];
% 
% X_wine_train=normalization(X_wine_train);
% X_wine_test=normalization(X_wine_test);
% 
% p = [26,139,101,130,30,51,110,63,11,140,50,46,61,44,145,78,21,70,118,120,40,55,45,132,48,57,20,34,105,143,39,113,146,35,104,116,1,22,54,85,97,89,56,76,16,111,127,14,102,91,136,122,31,71,62,82,144,4,19,93,65,128,112,18,37,68,125,47,94,64,124,58,10,3,88,8,86,52,7,9,134,121,108,5,75,90,137,38,107,60,80,142,109,103,133,36,135,2,25,95,32,106,74,114,12,23,33,79,117,99,83,6,92,42,29,53,24,123,138,67,41,81,84,119,98,27,115,126,17,69,49,59,73,28,72,43,77,100,129,15,96,131,141,87,13,66];
% X_wine_train=X_wine_train(p,:);
% Y_wine_train=Y_wine_train(p,:);
% 
% input_layer_size=13;
% first_hidden_layer_size=4;
% second_hidden_layer_size=2;
% output_layer_size=3;
% 
% initial_weight1 = [0.439316090863150,0.867224059002547,0.390160977940434,0.947404065728143;0.887803990892688,0.718057443104215,0.918470882166888,0.377517499288132;0.104335548387659,0.229948829973021,0.962318662424990,0.359319497596285;0.936902654950562,0.313905027787849,0.760074815816903,0.991161813249696;0.373502376809552,0.979004993314297,0.0729981068919502,0.325909586386921;0.161514895061171,0.941547656211502,0.423011379617674,0.892327466993633;0.0147947676700815,0.773027059676543,0.177926050366335,0.369957175363133;0.366348429957771,0.831140885519318,0.260026211402516,0.00240746173825723;0.429937230050648,0.0557528460337221,0.416720603453531,0.760933562217676;0.426556342285518,0.142278479328802,0.232604028269277,0.426664493937120;0.0171225879458681,0.504287621962141,0.171067748088712,0.130188311872015;0.307539316471976,0.674290708514621,0.434666637877531,0.851994944180563;0.270276711213381,0.175848686176578,0.225033051269020,0.470537003937769];
% initial_weight2 = [0.0129896386856617,0.872867200948221;0.938997016768878,0.0216649303380547;0.377365518147977,0.873914586294141;0.867280072532417,0.870306675611007];
% initial_weight3 = [0.107192475694637,0.414679447070394,0.535785090319854;0.959237690873160,0.917156886779444,0.248535177552180];
% initial_bias1   = [0.781895661479144,0.600883151996809,0.203635738208807,0.376289734847492];
% initial_bias2   = [0.0653669787273834,0.987481803077469];
% initial_bias3   = [0.516331063904652,0.945758317659188,0.216975759935149];
% disp 'start training wine';
% w1 = initial_weight1;
% w2 = initial_weight2;
% w3 = initial_weight3;
% b1 = initial_bias1;
% b2 = initial_bias2;
% b3 = initial_bias3;
% accuracy_rate_wine = zeros(50,1);
% count = 0;
% p_wine = predict(w1,w2,w3,b1,b2,b3,X_wine_test);
% while count<50
% for i=1:size(X_wine_train,1)
% [cost,w1,w2,w3,b1,b2,b3] = train_part1_hs(w1,w2,w3,b1,b2,b3,X_wine_train(i,:),Y_wine_train(i,:));
% end
% count = count +1;
% p_wine = predict(w1,w2,w3,b1,b2,b3,X_wine_test);
% accuracy_rate_wine(count) = accuracy(p_wine,Y_wine_test);
% end
% disp 'finish training wine';
% 
% 
% x_axis = 1:size(X_wine_test,1);
% plot(x_axis,Y_wine_test,'r',x_axis,p_wine,'bo');
% legend('desired output','prediction','location','northwest');
% 
% set(gcf, 'PaperPosition', [0 0 15 15]); %Position plot at left hand corner with width 5 and height 5.
% set(gcf, 'PaperSize', [15 15]); %Set the paper to have width 5 and height 5.
% saveas(gcf, 'winebhs1', 'pdf') %Save figure


% % breast-cancer-wisconsin
% load 'breast_mod.txt';
% X_breast_train=(breast_mod(1:555,1:9));
% Y_breast_train=(breast_mod(1:555,10));
% X_breast_test=(breast_mod(556:683,1:9));
% Y_breast_test=(breast_mod(556:683,10));
% 
% X_breast_train=normalization(X_breast_train);
% X_breast_test=normalization(X_breast_test);
% 
% for i=1:size(Y_breast_train,1)
%     if Y_breast_train(i)==2
%         Y_breast_train(i)=1;
%     else
%         Y_breast_train(i)=2;
%     end
% end
% 
% for i=1:size(Y_breast_test,1)
%     if Y_breast_test(i)==4
%         Y_breast_test(i)=2;
%     else
%         Y_breast_test(i)=1;
%     end
% end
% 
% for j=1:size(Y_breast_test,1)
%     for i=1:size(Y_breast_test,1)-1
%         if Y_breast_test(i) > Y_breast_test(i+1)
%             temp = Y_breast_test(i);
%             tempx = X_breast_test(i,:);
%             Y_breast_test(i) = Y_breast_test(i+1);
%             X_breast_test(i,:) = X_breast_test(i+1,:);
%             Y_breast_test(i+1) = temp;
%             X_breast_test(i+1,:) = tempx;
%         end
%     end
% end
% input_layer_size=9;
% first_hidden_layer_size=3;
% second_hidden_layer_size=3;
% output_layer_size=2;
% 
% initial_weight1 = [0.988439267199745,0.858759034071804,0.972651076977497;0.0899988149868883,0.789028923313949,0.710408685278170;0.320941032647761,0.317833053726229,0.311859945147533;0.511408938819178,0.452207453762982,0.291457127647727;0.0606063665682423,0.752227970049942,0.850357337374621;0.725687923545844,0.109861705750686,0.911647424007853;0.556555748561992,0.109742368593904,0.639276147276064;0.529359902481257,0.269883663704401,0.255370297944443;0.829982432033195,0.524637345396311,0.0886658400322831];
% initial_weight2 = [0.838255587537226,0.0610289291925092,0.827732173448263;0.584718619263320,0.584641303355111,0.190986440697398;0.948108735396022,0.285108085658642,0.442529962202884];
% initial_weight3 = [0.393411506367576,0.207603034379981;0.826573979042765,0.318104726150263;0.676871093438419,0.133810985356126];
% initial_bias1   = [0.671462889478031,0.570991075462406,0.169767066026489];
% initial_bias2   = [0.147655777151737,0.476079718267456,0.908102416506950];
% initial_bias3   = [0.552175026715835,0.0329398927498766];
% 
% w1 = initial_weight1;
% w2 = initial_weight2;
% w3 = initial_weight3;
% b1 = initial_bias1;
% b2 = initial_bias2;
% b3 = initial_bias3;
% disp 'start training breast';
% 
% accuracy_rate_breast = zeros(555,1);
% count = 0;
% p_breast = predict(w1,w2,w3,b1,b2,b3,X_breast_test);
% 
% for i=1:size(X_breast_train,1)
% [cost,w1,w2,w3,b1,b2,b3] = train_part1_hs(w1,w2,w3,b1,b2,b3,X_breast_train(i,:),Y_breast_train(i,:));
% p_breast = predict(w1,w2,w3,b1,b2,b3,X_breast_test);
% accuracy_rate_breast(i) = accuracy(p_breast,Y_breast_test);
% end
% count = count +1;
% 
% 
% disp 'finish training breast';
% x_axis = 1:size(X_breast_test,1);
% plot(x_axis,Y_breast_test,'r',x_axis,p_breast,'bo');
% legend('desired output','prediction','location','northwest');
% 
% set(gcf, 'PaperPosition', [0 0 15 15]); %Position plot at left hand corner with width 5 and height 5.
% set(gcf, 'PaperSize', [15 15]); %Set the paper to have width 5 and height 5.
% saveas(gcf, 'breastbhs1', 'pdf') %Save figure

%% Yeast
load 'yeast_mod.txt'

X_yeast_train=[(yeast_mod(1:370,1:8));(yeast_mod(464:806,1:8));(yeast_mod(893:1087,1:8)); ...
    (yeast_mod(1137:1266,1:8));(yeast_mod(1300:1340,1:8));(yeast_mod(1351:1385,1:8)); ...
    (yeast_mod(1395:1422,1:8));(yeast_mod(1430:1453,1:8));(yeast_mod(1460:1475,1:8)); ...
    (yeast_mod(1480:1483,1:8));];
Y_yeast_train=[(yeast_mod(1:370,9));(yeast_mod(464:806,9));(yeast_mod(893:1087,9)); ...
    (yeast_mod(1137:1266,9));(yeast_mod(1300:1340,9));(yeast_mod(1351:1385,9)); ...
    (yeast_mod(1395:1422,9));(yeast_mod(1430:1453,9));(yeast_mod(1460:1475,9)); ...
    (yeast_mod(1480:1483,9));];
X_yeast_test=[(yeast_mod(371:463,1:8));(yeast_mod(807:892,1:8));(yeast_mod(1088:1136,1:8)); ...
    (yeast_mod(1267:1299,1:8));(yeast_mod(1341:1350,1:8));(yeast_mod(1386:1394,1:8)); ...
    (yeast_mod(1423:1429,1:8));(yeast_mod(1454:1459,1:8));(yeast_mod(1476:1479,1:8)); ...
    (yeast_mod(1484,1:8));];
Y_yeast_test=[(yeast_mod(371:463,9));(yeast_mod(807:892,9));(yeast_mod(1088:1136,9)); ...
    (yeast_mod(1267:1299,9));(yeast_mod(1341:1350,9));(yeast_mod(1386:1394,9)); ...
    (yeast_mod(1423:1429,9));(yeast_mod(1454:1459,9));(yeast_mod(1476:1479,9)); ...
    (yeast_mod(1484,9));];
% X_yeast_train = [X_yeast_train; ...
%     X_yeast_train(1039:1186,:); X_yeast_train(1039:1186,:) ;X_yeast_train(1039:1186,:); ...
%     X_yeast_train(1115:1186,:); X_yeast_train(1115:1186,:); X_yeast_train(1115:1186,:)];
% Y_yeast_train = [Y_yeast_train; ...
%     Y_yeast_train(1039:1186,:); Y_yeast_train(1039:1186,:) ;Y_yeast_train(1039:1186,:); ...
%     Y_yeast_train(1115:1186,:); Y_yeast_train(1115:1186,:); Y_yeast_train(1115:1186,:)];

X_yeast_train=normalization(X_yeast_train);
X_yeast_test=normalization(X_yeast_test);

p = [1111,608,631,740,238,127,311,78,685,263,424,1022,944,1138,673,245,720,692,433,494,438,275,1157,312,524,357,544,112,26,1086,991,476,427,273,613,57,572,774,358,615,1034,986,534,999,339,918,801,706,708,1154,957,393,144,647,657,460,215,389,976,549,327,1163,888,806,517,1063,388,284,23,898,912,1,568,71,762,927,113,867,712,367,783,504,374,468,618,500,755,1048,1061,98,60,22,763,95,454,162,1065,1167,1036,307,90,574,815,172,325,642,453,786,316,512,231,408,1038,369,710,849,101,342,472,897,713,164,764,445,630,1142,58,431,798,935,997,191,1096,659,565,291,829,711,63,1088,1075,93,506,340,379,32,306,142,5,575,859,511,620,295,758,368,303,680,102,584,181,771,114,947,814,1112,289,304,59,623,258,1082,88,157,240,149,1083,624,955,329,621,751,109,1139,322,576,566,265,13,724,860,553,54,333,803,1159,1069,425,151,730,336,1129,56,27,65,800,1126,933,384,633,416,922,856,715,338,471,794,509,701,131,661,743,1079,577,1109,582,1057,118,1137,807,603,1023,1070,80,155,371,858,43,226,46,884,391,271,1183,376,528,956,747,571,721,848,788,643,434,259,705,372,828,92,1073,738,539,38,513,834,19,836,872,971,875,159,394,225,653,596,1064,241,1115,473,272,985,1116,754,386,185,739,925,961,523,462,840,1102,1045,588,907,328,1179,9,541,728,756,987,838,502,557,853,199,675,487,314,286,492,515,737,235,115,868,219,1006,279,76,580,281,683,148,880,797,1164,581,820,183,385,310,622,785,583,1131,979,36,734,1152,864,908,1141,877,72,1094,459,302,121,609,1008,31,293,47,542,326,870,477,664,274,748,978,1044,486,189,837,784,668,843,136,883,8,1020,190,290,636,950,305,552,813,381,120,651,691,55,401,288,699,278,81,804,704,177,652,718,928,937,1046,855,435,660,723,854,725,437,21,447,682,559,972,719,198,1181,267,480,508,1106,165,1133,1171,903,239,11,254,538,332,904,586,73,370,116,638,123,418,419,176,632,309,871,770,352,1105,694,481,128,1030,2,698,1132,79,268,1043,412,1002,493,677,450,1134,282,707,773,674,17,296,141,380,597,537,1033,451,485,15,135,6,264,589,678,330,129,593,1107,989,171,681,1155,1123,554,970,744,360,546,727,686,100,356,283,443,138,846,1153,1185,117,323,915,96,83,442,666,1151,910,256,107,12,466,186,931,139,249,977,1042,592,782,614,266,439,1184,29,470,280,1050,960,863,319,1054,377,1166,1182,1059,914,1144,378,261,514,218,250,919,902,844,1076,655,400,1101,958,983,133,87,817,1125,285,111,347,1091,1145,1110,547,826,441,349,1003,1018,35,821,89,230,1128,214,684,390,617,520,1118,587,1066,1014,1095,616,126,1058,432,822,578,810,930,375,1078,548,39,1037,166,1174,75,984,496,1097,551,776,938,1169,362,1178,1001,662,52,965,192,236,4,1081,521,879,716,676,41,841,590,160,213,287,173,1041,769,1143,217,465,229,1175,671,746,1011,778,975,205,366,501,522,174,404,168,212,61,42,732,585,516,298,315,669,1124,382,37,495,359,7,247,1084,601,993,543,687,757,649,964,890,77,929,456,644,1074,761,667,862,656,1180,562,1168,324,321,497,1093,277,405,227,1077,150,579,831,204,152,1013,945,158,233,1140,892,887,745,891,1068,952,819,980,50,201,1085,193,99,941,850,1035,137,570,478,1000,426,789,354,604,923,1087,341,899,714,1056,248,397,452,839,920,1172,750,153,180,865,475,759,654,1016,103,69,749,1015,1049,1072,827,1158,893,365,62,91,1149,84,479,110,558,595,981,237,560,292,202,564,942,301,25,982,665,1039,994,308,461,569,909,905,760,805,1114,1067,767,882,104,488,222,436,1119,387,1004,276,555,926,33,823,635,1071,795,792,67,53,648,939,187,709,253,467,346,697,808,703,536,1007,373,194,679,906,889,1103,94,1055,627,398,752,605,594,444,866,507,545,533,232,885,482,364,702,343,932,832,736,3,409,1100,86,851,34,134,484,428,145,350,40,1024,1135,211,913,663,49,483,175,423,733,833,464,894,966,448,260,796,634,954,811,791,167,1029,967,953,414,1161,790,64,731,300,924,988,641,936,766,881,429,729,824,1150,599,411,74,861,1005,1130,974,1148,299,1060,1092,1160,527,24,489,689,396,262,474,753,992,1162,420,14,1136,619,1031,842,959,1062,383,573,717,421,422,781,1113,963,334,700,602,1026,878,934,68,242,818,995,874,640,779,45,143,1080,658,793,499,200,921,140,735,869,1025,28,518,900,809,244,220,650,106,122,1028,591,85,355,812,255,458,765,413,269,639,949,645,1127,348,637,490,224,18,1027,209,535,1173,1170,20,406,392,246,361,210,610,415,125,780,629,607,802,119,772,510,48,1146,1053,646,498,741,206,410,672,178,66,320,70,951,1147,108,1017,10,1121,44,896,1186,132,777,825,430,876,407,449,318,742,799,446,503,491,1051,688,532,179,147,270,1032,1040,457,1090,223,1104,530,917,257,344,221,628,540,1120,146,943,402,353,690,169,195,852,1010,203,182,317,968,1047,216,969,722,973,345,695,901,252,567,184,857,403,207,531,1156,170,726,1108,208,505,197,1099,124,234,847,417,556,525,625,337,154,962,1176,563,600,1122,998,561,82,911,1012,1117,948,228,1098,696,845,463,940,395,97,873,611,130,1089,598,163,363,1052,835,335,895,16,105,768,550,30,1021,294,916,161,1165,455,886,440,1177,156,196,51,529,519,990,693,297,188,775,816,1019,351,612,606,946,996,830,313,626,399,670,526,243,469,787,251,1009,331];
X_yeast_train = X_yeast_train(p,:);
Y_yeast_train = Y_yeast_train(p,:);

input_layer_size=8;
first_hidden_layer_size=5;
second_hidden_layer_size=7;
output_layer_size=10;

initial_weight1 = [0.668720341144370,0.631523791706066,0.459063608782325,0.780406130800382,0.0305368090396591;0.251555306859931,0.392687632442449,0.0499580381749081,0.174497574180074,0.638002948882269;0.580059011500648,0.962289129023751,0.631230950798935,0.739170661517687,0.917456451879845;0.721353220518782,0.217037233818299,0.882261162487925,0.0940999170712845,0.526158025886541;0.103584942551737,0.920837235495621,0.728097471045074,0.635155734281023,0.412175549064325;0.0203174297243679,0.281734796992466,0.169080741746355,0.260176979718381,0.0473431305978874;0.895736568351373,0.842284305831856,0.629336561233378,0.566465399670023,0.847651133368451;0.598811423077382,0.232009290944639,0.678911498402068,0.853189220718317,0.122477600273339];
initial_weight2 = [0.138897336539528,0.441678504713852,0.993476545043372,0.345232960338547,0.609015759938280,0.681414471653610,0.691917509037218;0.620794873504470,0.711373122333743,0.876344962090679,0.689982730888525,0.424059140229988,0.525675262676818,0.960802912549019;0.689192826701967,0.731433716374766,0.549821683354076,0.618811214083726,0.607874984730777,0.983947099908334,0.376671618877646;0.320633051989302,0.865773882837725,0.0673311075033281,0.161608538065302,0.177857889076351,0.722019868630873,0.364116026680936;0.174458355679793,0.275533248453624,0.415842694923018,0.968861989300538,0.846832272781960,0.614736679750574,0.713910698416316];
initial_weight3 = [0.132852448789386,0.0930762961160675,0.627675593049696,0.0365168163927824,0.431080560609908,0.522132090732357,0.206045609707467,0.636696577773706,0.649807875709234,0.624021445400079;0.0563124246652709,0.853859480791349,0.939256900480177,0.417049616092637,0.541643315711653,0.677091790561467,0.768732868318131,0.0628511068858620,0.712369115610549,0.886830272444185;0.460667974058556,0.917452311246449,0.371154993479884,0.537013635992653,0.0186740586396355,0.514308813867680,0.378453121173868,0.946207854776252,0.855361584930754,0.700716163211474;0.500236288225750,0.811555043927379,0.819254573634958,0.00262197376965967,0.0940345522874341,0.774569782194906,0.887108959105217,0.553599714027005,0.198832171051666,0.491516329885654;0.968915448723789,0.387074854178176,0.359237031769273,0.964922454203697,0.546275462442743,0.846331869310095,0.648051434311852,0.00431801613446026,0.902633594526782,0.351154343397961;0.756368107510911,0.813054332694315,0.797159407935392,0.433033761359564,0.981742888242681,0.475421424110055,0.508995028363267,0.928203583185105,0.356910158091160,0.349618778676626;0.637752405749882,0.700916131680162,0.493779471329511,0.791743047280327,0.788174051941295,0.732965604748612,0.420484748225847,0.241851318088150,0.192768070515130,0.752037114503314];
initial_bias1   = [0.471404910090950,0.414677807042534,0.716435342144553,0.777324438247985,0.690868568811018];
initial_bias2   = [0.501722013259789,0.296117592982315,0.0469778029474766,0.674180251879333,0.479043739222703,0.309253005319193,0.432448747173499];
initial_bias3   = [0.989085723102398,0.453841389381472,0.416096846938995,0.602660893232394,0.0784093940614556,0.964084206585860,0.0423588393707359,0.800832746254681,0.358072689681612,0.430968891505573];

w1 = initial_weight1;
w2 = initial_weight2;
w3 = initial_weight3;
b1 = initial_bias1;
b2 = initial_bias2;
b3 = initial_bias3;
disp 'start training yeast';
iteration=500;
accuracy_rate_yeast = zeros(iteration,1);
for j=1:iteration 
for i=1:size(X_yeast_train,1)
[cost,w1,w2,w3,b1,b2,b3] = train_part1_hh_matrix(w1,w2,w3,b1,b2,b3,X_yeast_train(i,:),Y_yeast_train(i,:));
end
fprintf('%f  %',j/iteration); clc;
p_yeast = predict(w1,w2,w3,b1,b2,b3,X_yeast_test);
accuracy_rate_yeast(j,1) = accuracy(p_yeast,Y_yeast_test);
end
disp 'finish training yeast';
x_axis = 1:size(X_yeast_test,1);
plot(x_axis,Y_yeast_test,'r',x_axis,p_yeast,'bo');
legend('desired output','prediction','location','northwest');
title('yeast','FontSize', 14);
xlabel('data','FontSize', 14);
ylabel('class','FontSize', 14);
set(gcf, 'PaperPosition', [0 0 15 15]); %Position plot at left hand corner with width 5 and height 5.
set(gcf, 'PaperSize', [15 15]); %Set the paper to have width 5 and height 5.
saveas(gcf, 'yeasthh1', 'pdf') %Save figure